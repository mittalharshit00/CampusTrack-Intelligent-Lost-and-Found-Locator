{"ast":null,"code":"var _jsxFileName = \"/home/kali/Documents/Project/frontend/src/pages/ChatPage.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState, useContext } from \"react\";\nimport api from \"../services/api\";\nimport { AuthContext } from \"../context/AuthContext\";\nimport \"../styles/Chat.css\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst ChatPage = () => {\n  _s();\n  var _conversations$find, _conversations$find$i, _platformStats$total, _platformStats$open, _platformStats$matche, _platformStats$closed, _userStats$reported, _userStats$recovered, _userStats$notRecover;\n  const [conversations, setConversations] = useState([]);\n  const [selectedId, setSelectedId] = useState(null);\n  const [messages, setMessages] = useState([]);\n  const [messageBox, setMessageBox] = useState(\"\");\n  const {\n    user\n  } = useContext(AuthContext);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [showStats, setShowStats] = useState(false);\n  const [platformStats, setPlatformStats] = useState(null);\n  const [userStats, setUserStats] = useState(null);\n  const [statsLoading, setStatsLoading] = useState(false);\n\n  // Fetch conversations on mount\n  useEffect(() => {\n    fetchConversations();\n  }, []);\n  const fetchConversations = async () => {\n    try {\n      setLoading(true);\n      const res = await api.get(\"/chat/conversations\");\n      setConversations(res.data);\n      setError(null);\n    } catch (err) {\n      setError(\"Failed to load conversations. Please try again.\");\n      console.error(err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Fetch messages when selected conversation changes\n  useEffect(() => {\n    const fetchMessages = async () => {\n      try {\n        const res = await api.get(`/chat/conversations/${selectedId}/messages`);\n        setMessages(res.data);\n      } catch (err) {\n        console.error(\"Failed to fetch messages:\", err);\n      }\n    };\n    if (selectedId) {\n      fetchMessages();\n      // Poll for new messages every 2 seconds\n      const interval = setInterval(fetchMessages, 2000);\n      return () => clearInterval(interval);\n    }\n  }, [selectedId]);\n  const fetchStats = async () => {\n    try {\n      setStatsLoading(true);\n      const [platRes, userRes] = await Promise.all([api.get('/analytics/summary'), api.get('/analytics/user')]);\n      setPlatformStats(platRes.data);\n      setUserStats(userRes.data);\n    } catch (e) {\n      console.error('Failed to fetch stats', e);\n    } finally {\n      setStatsLoading(false);\n    }\n  };\n  const sendMessage = async () => {\n    if (!messageBox.trim()) return;\n    try {\n      await api.post(`/chat/conversations/${selectedId}/messages`, {\n        content: messageBox\n      });\n      setMessageBox(\"\");\n      // Fetch messages again to show the sent message\n      const res = await api.get(`/chat/conversations/${selectedId}/messages`);\n      setMessages(res.data);\n    } catch (err) {\n      var _err$response, _err$response$data, _err$response2;\n      const msg = ((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.message) || ((_err$response2 = err.response) === null || _err$response2 === void 0 ? void 0 : _err$response2.data) || err.message || 'Failed to send message';\n      setError(msg);\n      console.error('Send message error', err);\n    }\n  };\n  const handleKeyPress = e => {\n    if (e.key === \"Enter\" && !e.shiftKey) {\n      e.preventDefault();\n      sendMessage();\n    }\n  };\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chat-loading\",\n      children: \"Loading conversations...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 12\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"chat-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chat-header\",\n      children: /*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Messages\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chat-main\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"conversations-panel\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"Conversations\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 11\n        }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"error-message\",\n          children: error\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 21\n        }, this), conversations.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"empty-state\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"No conversations yet.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 115,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"hint\",\n            children: \"Contact someone about an item to start chatting.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 116,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(\"ul\", {\n          className: \"conversations-list\",\n          children: conversations.map(conversation => {\n            var _conversation$item, _conversation$userA, _conversation$userB, _conversation$item2, _conversation$item2$t, _conversation$item3;\n            return /*#__PURE__*/_jsxDEV(\"li\", {\n              className: `conversation-item ${selectedId === conversation.id ? \"active\" : \"\"}`,\n              onClick: () => setSelectedId(conversation.id),\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"conv-header\",\n                children: /*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: ((_conversation$item = conversation.item) === null || _conversation$item === void 0 ? void 0 : _conversation$item.title) || \"Unknown Item\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 129,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 128,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"conv-users\",\n                children: [(_conversation$userA = conversation.userA) === null || _conversation$userA === void 0 ? void 0 : _conversation$userA.name, \" & \", (_conversation$userB = conversation.userB) === null || _conversation$userB === void 0 ? void 0 : _conversation$userB.name]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 131,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"conv-item-type\",\n                children: /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: `badge ${(_conversation$item2 = conversation.item) === null || _conversation$item2 === void 0 ? void 0 : (_conversation$item2$t = _conversation$item2.type) === null || _conversation$item2$t === void 0 ? void 0 : _conversation$item2$t.toLowerCase()}`,\n                  children: (_conversation$item3 = conversation.item) === null || _conversation$item3 === void 0 ? void 0 : _conversation$item3.type\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 135,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 134,\n                columnNumber: 19\n              }, this)]\n            }, conversation.id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 121,\n              columnNumber: 17\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"messages-panel\",\n        children: selectedId ? /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"messages-header\",\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              children: ((_conversations$find = conversations.find(c => c.id === selectedId)) === null || _conversations$find === void 0 ? void 0 : (_conversations$find$i = _conversations$find.item) === null || _conversations$find$i === void 0 ? void 0 : _conversations$find$i.title) || \"Chat\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 150,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"conv-controls\",\n              children: ((_conv$userA, _conv$userB) => {\n                const conv = conversations.find(c => c.id === selectedId);\n                if (!conv) return null;\n                const isUserA = ((_conv$userA = conv.userA) === null || _conv$userA === void 0 ? void 0 : _conv$userA.email) === (user === null || user === void 0 ? void 0 : user.email);\n                const isUserB = ((_conv$userB = conv.userB) === null || _conv$userB === void 0 ? void 0 : _conv$userB.email) === (user === null || user === void 0 ? void 0 : user.email);\n                return /*#__PURE__*/_jsxDEV(_Fragment, {\n                  children: [!conv.approved && isUserB && /*#__PURE__*/_jsxDEV(\"button\", {\n                    className: \"btn-approve\",\n                    onClick: async () => {\n                      try {\n                        await api.post(`/chat/conversations/${selectedId}/approve`);\n                        // refresh conversations and messages\n                        await fetchConversations();\n                        const res = await api.get(`/chat/conversations/${selectedId}/messages`);\n                        setMessages(res.data);\n                      } catch (e) {\n                        console.error('Approve failed', e);\n                        setError('Failed to approve conversation');\n                      }\n                    },\n                    children: \"Approve\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 165,\n                    columnNumber: 27\n                  }, this), isUserA && (conv.blockedByA ? /*#__PURE__*/_jsxDEV(\"button\", {\n                    className: \"btn-ignore\",\n                    onClick: async () => {\n                      try {\n                        await api.post(`/chat/conversations/${selectedId}/unblock`);\n                        await fetchConversations();\n                      } catch (e) {\n                        console.error(e);\n                        setError('Failed to unblock');\n                      }\n                    },\n                    children: \"Unblock\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 187,\n                    columnNumber: 29\n                  }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n                    className: \"btn-ignore\",\n                    onClick: async () => {\n                      try {\n                        await api.post(`/chat/conversations/${selectedId}/block`);\n                        await fetchConversations();\n                      } catch (e) {\n                        console.error(e);\n                        setError('Failed to block');\n                      }\n                    },\n                    children: \"Block\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 189,\n                    columnNumber: 29\n                  }, this)), isUserB && (conv.blockedByB ? /*#__PURE__*/_jsxDEV(\"button\", {\n                    className: \"btn-ignore\",\n                    onClick: async () => {\n                      try {\n                        await api.post(`/chat/conversations/${selectedId}/unblock`);\n                        await fetchConversations();\n                      } catch (e) {\n                        console.error(e);\n                        setError('Failed to unblock');\n                      }\n                    },\n                    children: \"Unblock\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 194,\n                    columnNumber: 29\n                  }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n                    className: \"btn-ignore\",\n                    onClick: async () => {\n                      try {\n                        await api.post(`/chat/conversations/${selectedId}/block`);\n                        await fetchConversations();\n                      } catch (e) {\n                        console.error(e);\n                        setError('Failed to block');\n                      }\n                    },\n                    children: \"Block\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 196,\n                    columnNumber: 29\n                  }, this))]\n                }, void 0, true);\n              })()\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 155,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 149,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"messages-list\",\n            children: messages.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"empty-chat\",\n              children: /*#__PURE__*/_jsxDEV(\"p\", {\n                children: \"No messages yet. Start the conversation!\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 208,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 207,\n              columnNumber: 19\n            }, this) : messages.map(msg => {\n              var _msg$sender, _msg$sender2;\n              return /*#__PURE__*/_jsxDEV(\"div\", {\n                className: `message ${((_msg$sender = msg.sender) === null || _msg$sender === void 0 ? void 0 : _msg$sender.email) === (user === null || user === void 0 ? void 0 : user.email) ? \"sent\" : \"received\"}`,\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"message-header\",\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: (_msg$sender2 = msg.sender) === null || _msg$sender2 === void 0 ? void 0 : _msg$sender2.name\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 219,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"message-time\",\n                    children: new Date(msg.sentAt).toLocaleTimeString([], {\n                      hour: \"2-digit\",\n                      minute: \"2-digit\"\n                    })\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 220,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 218,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"message-content\",\n                  children: msg.content\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 227,\n                  columnNumber: 23\n                }, this)]\n              }, msg.id, true, {\n                fileName: _jsxFileName,\n                lineNumber: 212,\n                columnNumber: 21\n              }, this);\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 205,\n            columnNumber: 15\n          }, this), showStats && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"stats-panel\",\n            children: statsLoading ? /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"stats-loading\",\n              children: \"Loading stats...\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 237,\n              columnNumber: 21\n            }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"stats-grid\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"stats-card\",\n                children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                  children: \"Platform Analytics\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 241,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [\"Total Items: \", /*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: (_platformStats$total = platformStats === null || platformStats === void 0 ? void 0 : platformStats.total) !== null && _platformStats$total !== void 0 ? _platformStats$total : 0\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 242,\n                    columnNumber: 43\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 242,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [\"Open: \", /*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: (_platformStats$open = platformStats === null || platformStats === void 0 ? void 0 : platformStats.open) !== null && _platformStats$open !== void 0 ? _platformStats$open : 0\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 243,\n                    columnNumber: 36\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 243,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [\"Matched: \", /*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: (_platformStats$matche = platformStats === null || platformStats === void 0 ? void 0 : platformStats.matched) !== null && _platformStats$matche !== void 0 ? _platformStats$matche : 0\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 244,\n                    columnNumber: 39\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 244,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [\"Closed: \", /*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: (_platformStats$closed = platformStats === null || platformStats === void 0 ? void 0 : platformStats.closed) !== null && _platformStats$closed !== void 0 ? _platformStats$closed : 0\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 245,\n                    columnNumber: 38\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 245,\n                  columnNumber: 25\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 240,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"stats-card\",\n                children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                  children: \"Your Engagement\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 248,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [\"Reported: \", /*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: (_userStats$reported = userStats === null || userStats === void 0 ? void 0 : userStats.reported) !== null && _userStats$reported !== void 0 ? _userStats$reported : 0\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 249,\n                    columnNumber: 40\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 249,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [\"Recovered: \", /*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: (_userStats$recovered = userStats === null || userStats === void 0 ? void 0 : userStats.recovered) !== null && _userStats$recovered !== void 0 ? _userStats$recovered : 0\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 250,\n                    columnNumber: 41\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 250,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [\"Not Recovered: \", /*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: (_userStats$notRecover = userStats === null || userStats === void 0 ? void 0 : userStats.notRecovered) !== null && _userStats$notRecover !== void 0 ? _userStats$notRecover : 0\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 251,\n                    columnNumber: 45\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 251,\n                  columnNumber: 25\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 247,\n                columnNumber: 23\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 239,\n              columnNumber: 21\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 235,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"message-input-area\",\n            children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n              value: messageBox,\n              onChange: e => setMessageBox(e.target.value),\n              onKeyPress: handleKeyPress,\n              placeholder: \"Type your message... (Press Enter to send)\",\n              className: \"message-input\",\n              rows: \"3\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 259,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                display: 'flex',\n                gap: 8,\n                alignItems: 'center'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"btn-stats\",\n                title: \"Toggle engagement & analytics\",\n                onClick: async () => {\n                  const next = !showStats;\n                  setShowStats(next);\n                  if (next && !platformStats) {\n                    await fetchStats();\n                  }\n                },\n                children: \"\\uD83D\\uDCCA\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 268,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: sendMessage,\n                className: \"send-btn\",\n                children: \"Send\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 281,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 267,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 258,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true) : /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"no-selection\",\n          children: /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Select a conversation to start messaging\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 289,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 288,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 103,\n    columnNumber: 5\n  }, this);\n};\n_s(ChatPage, \"X3POznBjBBkdc55EAWu4Ew6rl1s=\");\n_c = ChatPage;\nexport default ChatPage;\nvar _c;\n$RefreshReg$(_c, \"ChatPage\");","map":{"version":3,"names":["React","useEffect","useState","useContext","api","AuthContext","jsxDEV","_jsxDEV","Fragment","_Fragment","ChatPage","_s","_conversations$find","_conversations$find$i","_platformStats$total","_platformStats$open","_platformStats$matche","_platformStats$closed","_userStats$reported","_userStats$recovered","_userStats$notRecover","conversations","setConversations","selectedId","setSelectedId","messages","setMessages","messageBox","setMessageBox","user","loading","setLoading","error","setError","showStats","setShowStats","platformStats","setPlatformStats","userStats","setUserStats","statsLoading","setStatsLoading","fetchConversations","res","get","data","err","console","fetchMessages","interval","setInterval","clearInterval","fetchStats","platRes","userRes","Promise","all","e","sendMessage","trim","post","content","_err$response","_err$response$data","_err$response2","msg","response","message","handleKeyPress","key","shiftKey","preventDefault","className","children","fileName","_jsxFileName","lineNumber","columnNumber","length","map","conversation","_conversation$item","_conversation$userA","_conversation$userB","_conversation$item2","_conversation$item2$t","_conversation$item3","id","onClick","item","title","userA","name","userB","type","toLowerCase","find","c","_conv$userA","_conv$userB","conv","isUserA","email","isUserB","approved","blockedByA","blockedByB","_msg$sender","_msg$sender2","sender","Date","sentAt","toLocaleTimeString","hour","minute","total","open","matched","closed","reported","recovered","notRecovered","value","onChange","target","onKeyPress","placeholder","rows","style","display","gap","alignItems","next","_c","$RefreshReg$"],"sources":["/home/kali/Documents/Project/frontend/src/pages/ChatPage.js"],"sourcesContent":["import React, { useEffect, useState, useContext } from \"react\";\nimport api from \"../services/api\";\nimport { AuthContext } from \"../context/AuthContext\";\nimport \"../styles/Chat.css\";\n\nconst ChatPage = () => {\n  const [conversations, setConversations] = useState([]);\n  const [selectedId, setSelectedId] = useState(null);\n  const [messages, setMessages] = useState([]);\n  const [messageBox, setMessageBox] = useState(\"\");\n  const { user } = useContext(AuthContext);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [showStats, setShowStats] = useState(false);\n  const [platformStats, setPlatformStats] = useState(null);\n  const [userStats, setUserStats] = useState(null);\n  const [statsLoading, setStatsLoading] = useState(false);\n\n  // Fetch conversations on mount\n  useEffect(() => {\n    fetchConversations();\n  }, []);\n\n  const fetchConversations = async () => {\n    try {\n      setLoading(true);\n      const res = await api.get(\"/chat/conversations\");\n      setConversations(res.data);\n      setError(null);\n    } catch (err) {\n      setError(\"Failed to load conversations. Please try again.\");\n      console.error(err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Fetch messages when selected conversation changes\n  useEffect(() => {\n    const fetchMessages = async () => {\n      try {\n        const res = await api.get(`/chat/conversations/${selectedId}/messages`);\n        setMessages(res.data);\n      } catch (err) {\n        console.error(\"Failed to fetch messages:\", err);\n      }\n    };\n\n    if (selectedId) {\n      fetchMessages();\n      // Poll for new messages every 2 seconds\n      const interval = setInterval(fetchMessages, 2000);\n      return () => clearInterval(interval);\n    }\n  }, [selectedId]);\n\n  const fetchStats = async () => {\n    try {\n      setStatsLoading(true);\n      const [platRes, userRes] = await Promise.all([\n        api.get('/analytics/summary'),\n        api.get('/analytics/user'),\n      ]);\n      setPlatformStats(platRes.data);\n      setUserStats(userRes.data);\n    } catch (e) {\n      console.error('Failed to fetch stats', e);\n    } finally {\n      setStatsLoading(false);\n    }\n  };\n\n  const sendMessage = async () => {\n    if (!messageBox.trim()) return;\n\n    try {\n      await api.post(`/chat/conversations/${selectedId}/messages`, {\n        content: messageBox,\n      });\n      setMessageBox(\"\");\n      // Fetch messages again to show the sent message\n      const res = await api.get(`/chat/conversations/${selectedId}/messages`);\n      setMessages(res.data);\n    } catch (err) {\n      const msg = err.response?.data?.message || err.response?.data || err.message || 'Failed to send message';\n      setError(msg);\n      console.error('Send message error', err);\n    }\n  };\n\n  const handleKeyPress = (e) => {\n    if (e.key === \"Enter\" && !e.shiftKey) {\n      e.preventDefault();\n      sendMessage();\n    }\n  };\n\n  if (loading) {\n    return <div className=\"chat-loading\">Loading conversations...</div>;\n  }\n\n  return (\n    <div className=\"chat-container\">\n      <div className=\"chat-header\">\n        <h2>Messages</h2>\n      </div>\n\n      <div className=\"chat-main\">\n        {/* Conversations List */}\n        <div className=\"conversations-panel\">\n          <h3>Conversations</h3>\n          {error && <div className=\"error-message\">{error}</div>}\n          {conversations.length === 0 ? (\n            <div className=\"empty-state\">\n              <p>No conversations yet.</p>\n              <p className=\"hint\">Contact someone about an item to start chatting.</p>\n            </div>\n          ) : (\n            <ul className=\"conversations-list\">\n              {conversations.map((conversation) => (\n                <li\n                  key={conversation.id}\n                  className={`conversation-item ${\n                    selectedId === conversation.id ? \"active\" : \"\"\n                  }`}\n                  onClick={() => setSelectedId(conversation.id)}\n                >\n                  <div className=\"conv-header\">\n                    <strong>{conversation.item?.title || \"Unknown Item\"}</strong>\n                  </div>\n                  <div className=\"conv-users\">\n                    {conversation.userA?.name} & {conversation.userB?.name}\n                  </div>\n                  <div className=\"conv-item-type\">\n                    <span className={`badge ${conversation.item?.type?.toLowerCase()}`}>\n                      {conversation.item?.type}\n                    </span>\n                  </div>\n                </li>\n              ))}\n            </ul>\n          )}\n        </div>\n\n        {/* Messages Panel */}\n        <div className=\"messages-panel\">\n          {selectedId ? (\n            <>\n              <div className=\"messages-header\">\n                <h3>\n                  {conversations\n                    .find((c) => c.id === selectedId)\n                    ?.item?.title || \"Chat\"}\n                </h3>\n                <div className=\"conv-controls\">\n                  {/* Approve button: show only if current user is userB (recipient) and conversation not approved */}\n                  {(() => {\n                    const conv = conversations.find((c) => c.id === selectedId);\n                    if (!conv) return null;\n                    const isUserA = conv.userA?.email === user?.email;\n                    const isUserB = conv.userB?.email === user?.email;\n                    return (\n                      <>\n                        {!conv.approved && isUserB && (\n                          <button\n                            className=\"btn-approve\"\n                            onClick={async () => {\n                              try {\n                                await api.post(`/chat/conversations/${selectedId}/approve`);\n                                // refresh conversations and messages\n                                await fetchConversations();\n                                const res = await api.get(`/chat/conversations/${selectedId}/messages`);\n                                setMessages(res.data);\n                              } catch (e) {\n                                console.error('Approve failed', e);\n                                setError('Failed to approve conversation');\n                              }\n                            }}\n                          >\n                            Approve\n                          </button>\n                        )}\n\n                        {/* Block/Unblock for current user */}\n                        {isUserA && (\n                          conv.blockedByA ? (\n                            <button className=\"btn-ignore\" onClick={async () => { try { await api.post(`/chat/conversations/${selectedId}/unblock`); await fetchConversations(); } catch(e){console.error(e); setError('Failed to unblock');} }}>Unblock</button>\n                          ) : (\n                            <button className=\"btn-ignore\" onClick={async () => { try { await api.post(`/chat/conversations/${selectedId}/block`); await fetchConversations(); } catch(e){console.error(e); setError('Failed to block');} }}>Block</button>\n                          )\n                        )}\n                        {isUserB && (\n                          conv.blockedByB ? (\n                            <button className=\"btn-ignore\" onClick={async () => { try { await api.post(`/chat/conversations/${selectedId}/unblock`); await fetchConversations(); } catch(e){console.error(e); setError('Failed to unblock');} }}>Unblock</button>\n                          ) : (\n                            <button className=\"btn-ignore\" onClick={async () => { try { await api.post(`/chat/conversations/${selectedId}/block`); await fetchConversations(); } catch(e){console.error(e); setError('Failed to block');} }}>Block</button>\n                          )\n                        )}\n                      </>\n                    );\n                  })()}\n                </div>\n              </div>\n\n              <div className=\"messages-list\">\n                {messages.length === 0 ? (\n                  <div className=\"empty-chat\">\n                    <p>No messages yet. Start the conversation!</p>\n                  </div>\n                ) : (\n                  messages.map((msg) => (\n                    <div\n                      key={msg.id}\n                      className={`message ${\n                        msg.sender?.email === user?.email ? \"sent\" : \"received\"\n                      }`}\n                    >\n                      <div className=\"message-header\">\n                        <strong>{msg.sender?.name}</strong>\n                        <span className=\"message-time\">\n                          {new Date(msg.sentAt).toLocaleTimeString([], {\n                            hour: \"2-digit\",\n                            minute: \"2-digit\",\n                          })}\n                        </span>\n                      </div>\n                      <div className=\"message-content\">{msg.content}</div>\n                    </div>\n                  ))\n                )}\n              </div>\n\n              {/* Stats panel (platform + user) */}\n              {showStats && (\n                <div className=\"stats-panel\">\n                  {statsLoading ? (\n                    <div className=\"stats-loading\">Loading stats...</div>\n                  ) : (\n                    <div className=\"stats-grid\">\n                      <div className=\"stats-card\">\n                        <h4>Platform Analytics</h4>\n                        <div>Total Items: <strong>{platformStats?.total ?? 0}</strong></div>\n                        <div>Open: <strong>{platformStats?.open ?? 0}</strong></div>\n                        <div>Matched: <strong>{platformStats?.matched ?? 0}</strong></div>\n                        <div>Closed: <strong>{platformStats?.closed ?? 0}</strong></div>\n                      </div>\n                      <div className=\"stats-card\">\n                        <h4>Your Engagement</h4>\n                        <div>Reported: <strong>{userStats?.reported ?? 0}</strong></div>\n                        <div>Recovered: <strong>{userStats?.recovered ?? 0}</strong></div>\n                        <div>Not Recovered: <strong>{userStats?.notRecovered ?? 0}</strong></div>\n                      </div>\n                    </div>\n                  )}\n                </div>\n              )}\n\n              <div className=\"message-input-area\">\n                <textarea\n                  value={messageBox}\n                  onChange={(e) => setMessageBox(e.target.value)}\n                  onKeyPress={handleKeyPress}\n                  placeholder=\"Type your message... (Press Enter to send)\"\n                  className=\"message-input\"\n                  rows=\"3\"\n                />\n                <div style={{ display: 'flex', gap: 8, alignItems: 'center' }}>\n                  <button\n                    className=\"btn-stats\"\n                    title=\"Toggle engagement & analytics\"\n                    onClick={async () => {\n                      const next = !showStats;\n                      setShowStats(next);\n                      if (next && !platformStats) {\n                        await fetchStats();\n                      }\n                    }}\n                  >\n                    ðŸ“Š\n                  </button>\n                  <button onClick={sendMessage} className=\"send-btn\">\n                    Send\n                  </button>\n                </div>\n              </div>\n            </>\n          ) : (\n            <div className=\"no-selection\">\n              <p>Select a conversation to start messaging</p>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default ChatPage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}